{%- liquid
  assign heading = section.settings.heading
  assign collection = collections[section.settings.collection]
  assign products_to_show = section.settings.products_to_show
-%}

<section class="featured-products section" data-section-id="{{ section.id }}">
  <div class="container">
    {%- if heading != blank -%}
      <div class="featured-products__header">
        <h2 class="section-heading">{{ heading }}</h2>
        {%- if collection != blank -%}
          <a href="{{ collection.url }}" class="featured-products__view-all">
            View All
            {% render 'icon', icon: 'chevron-right' %}
          </a>
        {%- endif -%}
      </div>
    {%- endif -%}

    {%- if collection != blank and collection.products.size > 0 -%}
      <div class="grid grid--4-col">
        {%- for product in collection.products limit: products_to_show -%}
          {% render 'product-card', product: product %}
        {%- endfor -%}
      </div>
    {%- else -%}
      <p class="featured-products__empty">No products found in this collection.</p>
    {%- endif -%}
  </div>
</section>

<style>
  .featured-products__header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 3rem;
  }

  .featured-products__view-all {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.875rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    transition: gap 0.2s ease;
  }

  .featured-products__view-all:hover {
    gap: 0.75rem;
  }

  .featured-products__view-all svg {
    width: 16px;
    height: 16px;
  }

  .featured-products__empty {
    text-align: center;
    color: var(--color-text-secondary);
    padding: 3rem 0;
  }
</style>

{% schema %}
{
  "name": "Featured Products",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Trending Now"
    },
    {
      "type": "collection",
      "id": "collection",
      "label": "Collection"
    },
    {
      "type": "range",
      "id": "products_to_show",
      "min": 2,
      "max": 12,
      "step": 1,
      "label": "Products to show",
      "default": 8
    }
  ],
  "presets": [
    {
      "name": "Featured Products"
    }
  ]
}
{% endschema %}
