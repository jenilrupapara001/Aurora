<section class="lookbook-grid section">
  <div class="container">
    {%- if section.settings.heading != blank -%}
      <h2 class="lookbook-grid__heading">{{ section.settings.heading }}</h2>
    {%- endif -%}

    <div class="lookbook-grid__layout lookbook-grid__layout--{{ section.settings.layout }}">
      {%- for block in section.blocks -%}
        <div class="lookbook-item" {{ block.shopify_attributes }}>
          {%- if block.settings.image != blank -%}
            <div class="lookbook-item__image">
              <img
                srcset="{{ block.settings.image | image_url: width: 600 }} 600w,
                        {{ block.settings.image | image_url: width: 800 }} 800w,
                        {{ block.settings.image | image_url: width: 1200 }} 1200w"
                src="{{ block.settings.image | image_url: width: 800 }}"
                alt="{{ block.settings.image.alt | escape }}"
                loading="lazy"
              >

              {%- if block.settings.overlay_text != blank or block.settings.button_label != blank -%}
                <div class="lookbook-item__overlay">
                  <div class="lookbook-item__content">
                    {%- if block.settings.overlay_text != blank -%}
                      <p class="lookbook-item__text">{{ block.settings.overlay_text }}</p>
                    {%- endif -%}

                    {%- if block.settings.button_label != blank and block.settings.button_link != blank -%}
                      <a href="{{ block.settings.button_link }}" class="lookbook-item__button button">
                        {{ block.settings.button_label }}
                      </a>
                    {%- endif -%}
                  </div>
                </div>
              {%- endif -%}
            </div>
          {%- endif -%}
        </div>
      {%- endfor -%}
    </div>
  </div>
</section>

<style>
  .lookbook-grid__heading {
    text-align: center;
    font-size: 2.5rem;
    margin-bottom: 3rem;
  }

  .lookbook-grid__layout {
    display: grid;
    gap: 1.5rem;
  }

  .lookbook-grid__layout--grid {
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  }

  .lookbook-grid__layout--masonry {
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    grid-auto-rows: 200px;
  }

  .lookbook-grid__layout--masonry .lookbook-item:nth-child(3n+1) {
    grid-row: span 2;
  }

  .lookbook-grid__layout--masonry .lookbook-item:nth-child(3n+2) {
    grid-row: span 3;
  }

  .lookbook-grid__layout--masonry .lookbook-item:nth-child(3n+3) {
    grid-row: span 2;
  }

  .lookbook-item {
    position: relative;
    overflow: hidden;
  }

  .lookbook-item__image {
    position: relative;
    width: 100%;
    height: 100%;
  }

  .lookbook-item__image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
    transition: transform 0.3s ease;
  }

  .lookbook-item:hover .lookbook-item__image img {
    transform: scale(1.05);
  }

  .lookbook-item__overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(to bottom, rgba(0,0,0,0) 0%, rgba(0,0,0,0.7) 100%);
    display: flex;
    align-items: flex-end;
    padding: 2rem;
    opacity: 0;
    transition: opacity 0.3s ease;
  }

  .lookbook-item:hover .lookbook-item__overlay {
    opacity: 1;
  }

  .lookbook-item__content {
    color: white;
    text-align: center;
    width: 100%;
  }

  .lookbook-item__text {
    font-size: 1.125rem;
    margin-bottom: 1rem;
  }

  .lookbook-item__button {
    background-color: white;
    color: var(--color-neutral-dark);
  }

  @media (max-width: 767px) {
    .lookbook-grid__layout {
      grid-template-columns: 1fr;
    }

    .lookbook-grid__layout--masonry .lookbook-item {
      grid-row: span 1 !important;
    }
  }
</style>

{% schema %}
{
  "name": "Lookbook Grid",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Shop the Look"
    },
    {
      "type": "select",
      "id": "layout",
      "label": "Layout",
      "options": [
        {
          "value": "grid",
          "label": "Grid"
        },
        {
          "value": "masonry",
          "label": "Masonry"
        }
      ],
      "default": "masonry"
    }
  ],
  "blocks": [
    {
      "type": "image",
      "name": "Lookbook Image",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "text",
          "id": "overlay_text",
          "label": "Overlay text"
        },
        {
          "type": "text",
          "id": "button_label",
          "label": "Button label",
          "default": "Shop now"
        },
        {
          "type": "url",
          "id": "button_link",
          "label": "Button link"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Lookbook Grid",
      "blocks": [
        {
          "type": "image"
        },
        {
          "type": "image"
        },
        {
          "type": "image"
        },
        {
          "type": "image"
        }
      ]
    }
  ]
}
{% endschema %}
