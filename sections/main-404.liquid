<section class="main-404 section">
  <div class="container">
    <div class="error-404">
      <h1 class="error-404__title">{{ section.settings.heading }}</h1>
      <p class="error-404__text">{{ section.settings.text }}</p>

      <div class="error-404__search">
        <form action="{{ routes.search_url }}" method="get" role="search" class="search-form">
          <input
            type="search"
            name="q"
            placeholder="{{ 'general.search.placeholder' | t }}"
            class="search-input"
            aria-label="{{ 'general.search.placeholder' | t }}"
          >
          <button type="submit" class="search-submit button">
            {{ 'general.search.submit' | t }}
          </button>
        </form>
      </div>

      <div class="error-404__actions">
        <a href="/" class="button button--primary">{{ 'general.404.link' | t }}</a>
        <a href="/collections/all" class="button button--secondary">{{ 'general.404.browse_products' | t }}</a>
      </div>

      {%- if section.settings.show_collections -%}
        <div class="error-404__collections">
          <h2>{{ 'general.404.popular_collections' | t }}</h2>
          <div class="collection-grid">
            {%- for collection in collections limit: 4 -%}
              {%- if collection.products_count > 0 -%}
                <a href="{{ collection.url }}" class="collection-card">
                  {%- if collection.image -%}
                    <div class="collection-card__image">
                      <img
                        src="{{ collection.image | image_url: width: 400 }}"
                        alt="{{ collection.image.alt | escape }}"
                        loading="lazy"
                      >
                    </div>
                  {%- endif -%}
                  <h3 class="collection-card__title">{{ collection.title }}</h3>
                  <p class="collection-card__count">{{ collection.products_count }} {{ 'general.404.products' | t }}</p>
                </a>
              {%- endif -%}
            {%- endfor -%}
          </div>
        </div>
      {%- endif -%}
    </div>
  </div>
</section>

<style>
  .error-404 {
    text-align: center;
    padding: 4rem 0;
    max-width: 800px;
    margin: 0 auto;
  }

  .error-404__title {
    font-size: 3rem;
    margin-bottom: 1rem;
  }

  .error-404__text {
    font-size: 1.25rem;
    color: var(--color-text-secondary);
    margin-bottom: 3rem;
  }

  .error-404__search {
    margin-bottom: 2rem;
  }

  .error-404__search .search-form {
    display: flex;
    max-width: 500px;
    margin: 0 auto;
    border: 2px solid var(--color-border);
  }

  .error-404__search .search-input {
    flex: 1;
    padding: 1rem 1.5rem;
    border: none;
    font-size: 1rem;
  }

  .error-404__search .search-submit {
    padding: 1rem 1.5rem;
  }

  .error-404__actions {
    display: flex;
    justify-content: center;
    gap: 1rem;
    flex-wrap: wrap;
    margin-bottom: 4rem;
  }

  .error-404__collections {
    margin-top: 4rem;
    padding-top: 4rem;
    border-top: 1px solid var(--color-border);
  }

  .error-404__collections h2 {
    font-size: 1.5rem;
    margin-bottom: 2rem;
  }

  .collection-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 1.5rem;
  }

  .collection-card {
    text-decoration: none;
    color: inherit;
    transition: transform 0.2s ease;
  }

  .collection-card:hover {
    transform: translateY(-4px);
  }

  .collection-card__image {
    aspect-ratio: 3 / 4;
    margin-bottom: 1rem;
    overflow: hidden;
  }

  .collection-card__image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.3s ease;
  }

  .collection-card:hover .collection-card__image img {
    transform: scale(1.05);
  }

  .collection-card__title {
    font-size: 1.125rem;
    margin-bottom: 0.5rem;
  }

  .collection-card__count {
    font-size: 0.875rem;
    color: var(--color-text-secondary);
  }

  @media (max-width: 767px) {
    .error-404__title {
      font-size: 2rem;
    }

    .error-404__actions {
      flex-direction: column;
    }

    .collection-grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }
</style>

{% schema %}
{
  "name": "404 Page",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Page not found"
    },
    {
      "type": "textarea",
      "id": "text",
      "label": "Text",
      "default": "The page you were looking for does not exist. Try searching or return to the homepage."
    },
    {
      "type": "checkbox",
      "id": "show_collections",
      "label": "Show popular collections",
      "default": true
    }
  ]
}
{% endschema %}
